/*--------------------------------------------------------------------------------*
 * Name: Parser Look-up tree
 * Desc: function and data structures to speed up a specific string search
 *
 *         **** DO NOT AMEND THIS CODE - IT IS AUTO_GENERATED ****
 *
 * Code and table produced by:
 *            build_graph 
 *            version 0.3
 *
 *  written by Peter Antoine. 
 *
 *   **** This code can be used however you like, no claims whatsoever are ****
 *   **** placed on the auto-generated code or data, or on the code that   ****
 *   **** uses the that code or data.                                      ****
 *   **** Or, to paraphrase "Fill you're boots".                           ****
 *--------------------------------------------------------------------------------*/

#include "http_headers.h"

HTTP_HEADERS_STRING_TABLE	http_headers_table[52] = {
		{"CACHE-CONTROL",13},
		{"CONNECTION",10},
		{"DATE",4},
		{"PRAGMA",6},
		{"TRAILER",7},
		{"TRANSFER-ENCODING",17},
		{"UPGRADE",7},
		{"VIA",3},
		{"WARNING",7},
		{"ACCEPT",6},
		{"ACCEPT-CHARSET",14},
		{"ACCEPT-ENCODING",15},
		{"ACCEPT-LANGUAGE",15},
		{"AUTHORIZATION",13},
		{"EXPECT",6},
		{"FROM",4},
		{"HOST",4},
		{"IF-MATCH",8},
		{"IF-MODIFIED-SINCE",17},
		{"IF-NONE-MATCH",13},
		{"IF-RANGE",8},
		{"IF-UNMODIFIED-SINCE",19},
		{"MAX-FORWARDS",12},
		{"PROXY-AUTHORIZATION",19},
		{"RANGE",5},
		{"REFERER",7},
		{"TE",2},
		{"USER-AGENT",10},
		{"ACCEPT-RANGES",13},
		{"AGE",3},
		{"ETAG",4},
		{"LOCATION",8},
		{"PROXY-AUTHENTICATE",18},
		{"RETRY-AFTER",11},
		{"SERVER",6},
		{"VARY",4},
		{"WWW-AUTHENTICATE",16},
		{"ALLOW",5},
		{"CONTENT-ENCODING",16},
		{"CONTENT-LANGUAGE",16},
		{"CONTENT-LENGTH",14},
		{"CONTENT-LOCATION",16},
		{"CONTENT-MD5",11},
		{"CONTENT-RANGE",13},
		{"CONTENT-TYPE",12},
		{"EXPIRES",7},
		{"LAST-MODIFIED",13},
		{"EXTENSION-HEADER",16},
		{"KEEP-ALIVE",10},
		{"COOKIE",6},
		{"SET-COOKIE",10},
		{"SET-COOKIE2",11}
};

static signed char	symbol_table[256] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x05,0x00,0x00,
								 0x00,0x00,0x1A,0x00,0x00,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x02,0x00,0x01,0x0C,0x04,0x11,0x0E,0x03,0x0B,0x00,0x19,0x0A,0x0F,0x07,0x06,
								 0x0D,0x00,0x09,0x10,0x08,0x12,0x13,0x14,0x16,0x17,0x15,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x02,0x00,0x01,0x0C,0x04,0x11,0x0E,0x03,0x0B,0x00,0x19,0x0A,0x0F,0x07,0x06,
								 0x0D,0x00,0x09,0x10,0x08,0x12,0x13,0x14,0x16,0x17,0x15,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

static unsigned char	state_machine_table[55][26] = {
								{0x00,0x01,0x0C,0xEF,0x14,0x00,0x00,0x00,0x06,0x23,0x25,0x17,0xFD,0x04,0x00,0xE9,
								 0x26,0xF0,0x09,0x0A,0x0B,0x00,0x00,0x00,0x00,0xCF},
								{0x00,0x00,0xFF,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0xCE,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x28,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x05,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xFC,0x00,0x00,0x00,0x1B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0xE5,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFA,0x00,0x00,0x00,0xFB,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF9,0x00,0x00,
								 0xE4,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xDC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xF7,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0xDB,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x0D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xDA,0x00,0x00,0x00,0xE2,0x00,
								 0x00,0x00,0xF2,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x0E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x12,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0xF6,0x00,0x00,0x00,0x00,0x13,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0xF5,0x00,0x00,0xF4,0x00,0x00,0x00,0x00,0xE3,0xF3,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE1,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x15,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xD0,0x00,0x00,0x00,0x00,0x16,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0xF1,0x00,0x00,0x00,0x00,0x00,0x00,0xD2,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x19,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xEC,0x00,0xEB,0x00,0x00,0x00,0x00,0x00,0x1A,
								 0x00,0x00,0xEA,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xEE,0x00,0x00,0x00,0xED,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x1C,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x1D,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x1E,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x1F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x21,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x22,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0xDF,0x00,0xE8,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xE7,0x00,0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xDE,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0xE6,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xD1,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x27,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2E,0xDD,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x29,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2A,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x2C,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0xD9,0x00,0x00,0x00,0xD3,0xD4,0x2D,0x00,0x00,0x00,0x00,0xD5,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0xD8,0x00,0xD7,0x00,0xD6,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x2F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x31,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x32,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x33},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x34,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x36,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
								{0xCD,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}};


int	http_headers_check_word(unsigned char* word)
{
	signed char	line = 0;
	int	count = 0;
	int letter = 0;

	do
	{
		line = (signed char) state_machine_table[line][symbol_table[word[letter]]];
		letter++;
	}
	while (line > 0 && word[letter] != '\0');

	if (line < 0)
		line = (0-line) - 1;
	else if ((line = (signed char) state_machine_table[line][symbol_table[0]]) < 0)
		line = (0-line) - 1;
	else
		line = -1;

	if (line >= 0)
	{
		for (count=letter;count < http_headers_table[line].length;count++)
		{
			if (toupper(word[count]) != http_headers_table[line].name[count])
			{
				line = -1;
				break;
			}
		}
	}
	return line;
}
